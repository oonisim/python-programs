[objective]
Baseline for Huggingface model with equal balanced data.

positive_negative_ratio=1.0,
negative_replication_factor=1.0,

[toxic        ] Threshold 0.99865
[toxic        ] TP 0.068 FP 0.030 TN: 0.875 FN 0.027
[toxic        ] True Positive Rate (Recall)      : 0.716
[toxic        ] Positive Precision               : 0.695
[toxic        ] True Negative Rate (Specificity) : 0.967
[toxic        ] Negative Precision               : 0.970
[toxic        ] Accuracy                         : 0.943
[toxic        ] AUC                              : 0.967

[toxic        ] Threshold 0.50000
[toxic        ] TP 0.087 FP 0.087 TN: 0.818 FN 0.008
[toxic        ] True Positive Rate (Recall)      : 0.913
[toxic        ] Positive Precision               : 0.499
[toxic        ] True Negative Rate (Specificity) : 0.904
[toxic        ] Negative Precision               : 0.990
[toxic        ] Accuracy                         : 0.905
[toxic        ] AUC                              : 0.967

[toxic        ] Threshold 0.06537
[toxic        ] TP 0.090 FP 0.107 TN: 0.798 FN 0.005
[toxic        ] True Positive Rate (Recall)      : 0.946
[toxic        ] Positive Precision               : 0.458
[toxic        ] True Negative Rate (Specificity) : 0.882
[toxic        ] Negative Precision               : 0.994
[toxic        ] Accuracy                         : 0.888
[toxic        ] AUC                              : 0.967

TIMESTAMP = 2021JUL18_1338
CLEANING_FOR_TRAINING = False
MAX_SEQUENCE_LENGTH = 256
FREEZE_BASE_MODEL = False
NUM_LABELS = 2
NUM_EPOCHS = 5
BATCH_SIZE = 32
LEARNING_RATE = 2e-05
L2 = 0.0001
METRIC_NAME = loss
REDUCE_LR_PATIENCE = 1
EARLY_STOP_PATIENCE = 3
RESULT_DIRECTORY = /content/drive/MyDrive/home/repository/mon/kaggle/toxic_comment_classification/toxicity_classification_2021JUL18_1338

Model: "tf_distil_bert_for_sequence_classification_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
distilbert (TFDistilBertMain multiple                  66362880
_________________________________________________________________
pre_classifier (Dense)       multiple                  590592
_________________________________________________________________
classifier (Dense)           multiple                  1538
_________________________________________________________________
dropout_79 (Dropout)         multiple                  0
=================================================================
Total params: 66,955,010
Trainable params: 66,955,010
Non-trainable params: 0
_________________________________________________________________
Epoch 1/5
7214/7214 [==============================] - 3691s 510ms/step - loss: 0.0958 - accuracy: 0.9656 - val_loss: 0.0478 - val_accuracy: 0.9852
Model val_loss improved from [inf] to [0.04781]
Saving to /content/drive/MyDrive/home/repository/mon/kaggle/toxic_comment_classification/toxicity_classification_2021JUL18_1338/model_Ctoxic_B32_L256
Epoch 2/5
7214/7214 [==============================] - 3679s 510ms/step - loss: 0.0283 - accuracy: 0.9919 - val_loss: 0.0394 - val_accuracy: 0.9890
Model val_loss improved from [0.04781] to [0.03942]
Saving to /content/drive/MyDrive/home/repository/mon/kaggle/toxic_comment_classification/toxicity_classification_2021JUL18_1338/model_Ctoxic_B32_L256
Epoch 3/5
7214/7214 [==============================] - 3685s 511ms/step - loss: 0.0151 - accuracy: 0.9958 - val_loss: 0.0317 - val_accuracy: 0.9924
Model val_loss improved from [0.03942] to [0.03172]
Saving to /content/drive/MyDrive/home/repository/mon/kaggle/toxic_comment_classification/toxicity_classification_2021JUL18_1338/model_Ctoxic_B32_L256
Epoch 4/5
7214/7214 [==============================] - 3688s 511ms/step - loss: 0.0100 - accuracy: 0.9972 - val_loss: 0.0364 - val_accuracy: 0.9923

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.999999898951501e-06.
Epoch 5/5
7214/7214 [==============================] - 3696s 512ms/step - loss: 0.0029 - accuracy: 0.9992 - val_loss: 0.0436 - val_accuracy: 0.9936

Epoch 00005: ReduceLROnPlateau reducing learning rate to 7.999999979801942e-07.